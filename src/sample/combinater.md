#Bogdanp/elm-combine

パーサーコンビネータライブラリを使ってパーサーを書いてみます。

コンビネーターとは、関数を組み合わせて新しい関数を返す関数をそう言うそうです。例えば、２つの関数をとって一つにする合成演算子(<<)はコンビネータと言えます。

```
(<<) : (b -> c) -> (a -> b) -> (a -> c)
(<<) g f x =
  g (f x)
```

パーサーとは、文字（記号）列を受け取って頭から一文字づつ読んでいって、何かが起こるみたいな関数を指します。

例えば
* 文字列を定めたルール、仕様、文法にそったものか判断する。（判定、構文解析）
* 文字列を定めたルール、仕様、文法にそって別の文字列に変換する。（書き換え、コンパイラ、トランスパイラ、翻訳）
* 文字列を定めたルール、仕様、文法にそって実行、解釈する。（dslとかevalとか）
* 文字列の中から特定の文字列を検索する（これは正規表現ライブラリの方が得意なことが多い、なんか書くの難しい）

パーサーコンビネータライブラリとは、関数を構成してパーサー関数を作る関数のライブラリです。上記のようなプログラムを、関数を組み合わせるように書くことが出来ます。

他に似たツールとして正規表現とパーサージェネレータがあります。
正規表現は正規表現を渡すとその文字列のパターンマッチを自動生成します。
パーサージェネレータは構文規則を渡すと、その構文解析器、コンパイラを自動生成します。
パーサーコンビネータは、一文字づつ文字列を読んでくプログラム（パーサー）を書きやすくするツールです。


Elmパッケージライブラリには２つのパーサーコンビネータライブラリがあります。今回はBogdanp/elm-combineというのを使います。


メモ：パーサーコンビネータライブラリの多くは、Haskellのparsecライブラリを参考にしています。なのでpersecの情報も参考になると思います。

#実行

パーサーコンビネータはパーサーを作ったあと、parseで実行します。

```
parse : Parser res -> String -> (Result res, Context)

```
parseはパーサーと対象文字列を受け取って、結果とContextのタプルを返します。
Contextには、パースしたあと残った文字列（次のパーサーがパースする部分）と、どこまでパースしたかのカウントが入っています（次のパーサーの開始位置）。


```
targetStr = "aaaaa"

yourParser = many <| string "a"

result = parse yourParser targetStr  --(Ok ["a","a","a","a","a"],{ input = "", position = 5 })
```

パースに失敗すると、Errになります。

```
parse (string "ab") "abc"  --(Ok "ab",{ input = "c", position = 2 })
parse (string "ab") "x" --(Err (["expected \"ab\""]),{ input = "x", position = 0 })
```

Errになるとエラー文が入っています。上記だと「ab」が必要と入っています。このエラー部分はいじることが出来ます。




頭から読んでいきます
正規表現だと勝手に読み飛ばしてくれたりしますが、

文字集合を書くのに便利

```
```



#言語

言語とは、とりあえずここでは人工の言語を指します。人工なのでルールであるとか仕様であるとかいったものがあります。
そのルールであるとか仕様であるのが、文法といいます。
なので言語といえば文法があって、文法があれば、その文法で解析したり生成できる言語があります。

言語には演算子が定義されていて、




正規表現

a,b,c,d,e....z.!"#$% のような（記号を含む）表記を文字と呼びます。
それらが固まったものを単語と呼びます。abc hello 2k49fk#
何も文字列がないを表記は""とします。数字でいうゼロに当たります。

「文字が並ぶこと」、をさして連接すると呼びます。abcならaとbとcが連接していると言えます。これは数字で言うと足し算に当たります、演算子にあたるものは省略して”くっつけて”しまうことで表現します。

足し算が掛け算になるように、並ぶことが連続すること、をスターといいます。aaa...ならaのスターです。演算子は*です。これを使うとa*とかb*という表記になります。

連続するのが無限回か有限回か指定するには。{0,20}のように書きます。

といった集合が正規表現といいます。数字で例えると、1,2,3,4...があって、(+),(x)といった演算子があって、名前はIntといった感じです。

Elmにも正規表現というライブラリが用意されています。このライブラリを使うと上記のような表現で正規表現を構成してさらに、その構成した正規表現を使って、文字列を検索したり、といったことまで出来ます。

使ってみましょう。

正規表現という集合では表現できない文字列があります。それは再帰、入れ子ルールがある文字列です。

```


```


再帰や入れ子のルールが入ったのが形式言語です。
