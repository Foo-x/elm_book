#Elmを使った開発環境構築

ここではElmを使った開発環境を構築していきましょう。

##構成

* Git              --ソースコードのバージョン管理
* Node(npm)        --ライブラリなどのパッケージ管理システム
* Elm 0.18         
* elm-format       --自動整形ツール
* webpack          --フロントエンドのビルドツール

npmを使いElmを含めたフロントエンド環境のライブラリやツールのバージョン管理を行います。

elm-formatはElmソースコードをElm公式スタイルガイドのスタイルで整形してくれるツールです。
elm-formatを使ってElmソースコードを整形します。

webpackはフロントエンドのソースコード全般の管理ツールです。
webpackを使ってホットリロードによる開発と、ビルドを行います。

##npm(またはyarn)

Nodeは、JSを使ってサーバーが書けるサーバーアプリケーションです。
JSでサーバーアプリケーションを書けること、windows、mac、Linuxどの環境でもインストール出来て使えることから、発表時から爆発的に普及しました。

またNodeはnpmというパッケージ管理ツールを備えていました。なのでnpmにJSアプリケーションなどを公開して自由にダウンロード出来るようになりました。

Nodeとnpmによって、ブラウザアプリケーション開発も大きく変わりました。Nodeは単体でもサーバーとして使うことが出来ますが、サーバー機能を使った開発者用ツールも作ることが出来ます。なので、開発者全員の環境にNodeをインストールして、npmを使いブラウザで使うライブラリや、開発で使うツール類などを管理するようになりました。

サーバー機能を使った開発者用ツールとして、ファイルを監視して更新すると即座に再コンパイルしてブラウザに反映するなどのタスク管理ツールが興隆しました。Gruntやgulpといったツールがそれにあたります。今回使うwebpackも同じ目的のツールです。そして現在webpack2という次のバージョンも出ているので、じきにwebpack2を使うと思います。

yarnとは、npmの不便な所を簡単なコマンドで行えるようにしてくれるツールです。最近使われだしています。

ではNodeをインストールして、npmを使います。

##Nodeをインストール

Nodeの公式ページに行き、インストーラをダウンロードして使います。stableと開発バージョンの２つが公開されていますが、どちらでも構いません。

Node自体のバージョンも管理する必要がありますが、今回は扱いません。必要になったら調べてみてください。

Nodeをインストールしたら、npmについて説明します。

##npm

npmはNodeに搭載されたバージョン管理システムです。

npmはpackage.jsonという設定ファイルを見て、どんなパッケージがこのプロジェクトには入っているかな？とか見てくれます。

初めてプロジェクトを作ったら、package.jsonファイルを作ります。簡単に作るためのコマンドがnpmに用意されています。

```
npm init
```

質問に答えるとpackage.jsonが作られます。

###npmスクリプト

package.jsonファイルを眺めてみます。

```
```

##Elm

Elmはnpmでも公開されています。以下のコマンドでインストール可能です。

```
npm install -g elm
```

あとは、npmスクリプトでElmのコマンドを実行します。


##elm-format

[avh4/elm-format](https://github.com/avh4/elm-format)

elm-formatは、Elmコードをきれいに整形してくれるツールです。注意したいコードがあった場合も教えてくれます。（例:インポートしても使わないライブラリがあるなど）

関連してelm-formatをエディタで使えるようにするプラグインも多数公開されています。

複数人で開発する場合は、すべてのElmソースコードをelm-formatを使い整形するようにします。ですが今回は一人で開発する規模くらいを想定しているので、エディタでelm-formatを使えるようにして、ファイルをエディタで変更保存するたびに自動で整形するようにします。

###インストール

MacとLinuxとwindowsそれぞれのバイナリが公開されています。
バイナリをダウンロードしてフォルダに設置します。設置した場所のパスを環境変数に設定します。

###エディタにプラグインを設定する。

elm-formatのドキュメントには、エディタへのプラグイン対応状況とプラグイン名と簡単な設定方法が載っています。
各プラグインのgithubページも参考にしてみてください。自分のエディタにあったプラグインをインストールして、elm-formatをエディタから使えるようにします。

例えばAtom（エディタ）では、atom-elm-formatとatom-beautifyというelm-formatを使うことが出来るプラグインが紹介されています。

Atomで設定してみます。ctrl + shift + p から、open setting panelを選び、設定パネルのインストールからatom-beautifyをインストールします。
設定パネルのpackage欄からatom-beautifyを検索します。設定のElmの欄からelm-formatを選択してセーブ時にフォーマットを行うようにチェックを入れると完了です。

##webpack

webpackとは、フロントエンド環境のソースコード全般を管理するツールです。

フロントエンドにはHTMLやCSSやJSやElmといったコードがありますが、それらはHTMLならミニファイし、SCSSならコンパイル、JSならbabelでトランスパイラして、すべてHTMLにリンクして、適切な位置に配置する必要があります。とても面倒な作業が多いので、webpackにすべてやってもらおうというわけです。

他にも似たことが出来るGrantやgulpといったツールがありますが、今回使うのはwebpackにしました。それはGruntやgulpは構文を覚える必要があり、難しさが構文とやりたい事の掛け算になりますが、webpackは設定を書くという一つの行為で済むためシンプルだと思ったからです。また沢山の開発者がいてバグが少ないことが挙げられます。

###elm-webpack-starter

elm-webpack-starterはwebpackを使ったElm開発環境ボイラープレートです。
こちらのプロジェクトを参考すると、webpackの設定方法や、webpackでのElmの構成がわかって大変勉強になります。

[moarwick/elm-webpack-starter](https://github.com/moarwick/elm-webpack-starter)

elm-webpack-starterの設定を見てみます。
